
<div class="todos-container fade-in">
  <!-- Add New Task Section -->
  <div class="add-task-section">
    <app-add-todo (todoAdd)="addToDo($event)"></app-add-todo>
  </div>
  
  <!-- Filter and Search Section -->
  <div class="filter-section" *ngIf="todos.length > 0">
    <div class="filter-controls">
      <div class="category-filter">
        <label for="categoryFilter" class="filter-label">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
            <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/>
          </svg>
          Filter by category
        </label>
        <select class="form-select compact" id="categoryFilter" [(ngModel)]="selectedCategory" (change)="onCategoryChange()">
          <option *ngFor="let cat of categories" [value]="cat">{{cat}}</option>
        </select>
      </div>
      
      <div class="task-stats">
        <span class="stat-item">
          <span class="stat-number">{{filteredTodos.length}}</span>
          <span class="stat-label">Total</span>
        </span>
        <span class="stat-divider">â€¢</span>
        <span class="stat-item">
          <span class="stat-number">{{getCompletedCount()}}</span>
          <span class="stat-label">Completed</span>
        </span>
      </div>
    </div>
  </div>
  
  <!-- Tasks List -->
  <div class="tasks-list">
    <div *ngIf="filteredTodos.length === 0; else tasksTemplate" class="empty-state">
      <div class="empty-icon">
        <svg width="64" height="64" viewBox="0 0 24 24" fill="currentColor" opacity="0.3">
          <path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1z"/>
        </svg>
      </div>
      <h3 class="empty-title">
        <span *ngIf="selectedCategory === 'All'; else categoryEmpty">No tasks yet</span>
        <ng-template #categoryEmpty>No tasks in "{{selectedCategory}}"</ng-template>
      </h3>
      <p class="empty-description">
        <span *ngIf="selectedCategory === 'All'; else categoryEmptyDesc">Add a task above to get started with your productivity journey.</span>
        <ng-template #categoryEmptyDesc>Try selecting a different category or add a new task.</ng-template>
      </p>
    </div>
    
    <ng-template #tasksTemplate>
      <div class="tasks-grid">
        <div class="task-item-wrapper" *ngFor="let todo of filteredTodos; let i = index; trackBy: trackByTodo" 
             [class.completed]="!todo.active">
          <app-todo-item 
            [todo]="todo" 
            [i]="i" 
            (todoDelete)="deleteToDo($event)" 
            (todoCheckBox)="toggleCheck($event)"
            class="task-item fade-in">
          </app-todo-item>
        </div>
      </div>
      
      <!-- Completed Tasks Section -->
      <div class="completed-section" *ngIf="getCompletedTodos().length > 0">
        <button class="completed-header" (click)="toggleCompletedVisibility()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" 
               [style.transform]="showCompleted ? 'rotate(90deg)' : 'rotate(0deg)'">
            <path d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/>
          </svg>
          <span>Completed ({{getCompletedTodos().length}})</span>
        </button>
        
        <div class="completed-tasks" *ngIf="showCompleted">
          <div class="task-item-wrapper completed" *ngFor="let todo of getCompletedTodos(); let i = index; trackBy: trackByTodo">
            <app-todo-item 
              [todo]="todo" 
              [i]="i" 
              (todoDelete)="deleteToDo($event)" 
              (todoCheckBox)="toggleCheck($event)"
              class="task-item fade-in">
            </app-todo-item>
          </div>
        </div>
      </div>
    </ng-template>
  </div>
</div>
